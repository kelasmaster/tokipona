<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Toki Pona Grammar Checker</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 2em auto; padding: 1em; }
    textarea { width: 100%; height: 100px; font-size: 1.2em; }
    .error { color: red; margin-top: 1em; }
    .success { color: green; margin-top: 1em; }
  </style>
</head>
<body>
  <h2>Toki Pona Grammar Checker (Demo)</h2>
  <textarea id="tpInput" placeholder="Write a sentence in Toki Pona...">mi moku e kili</textarea>
  <button onclick="checkGrammar()">Check</button>
  <div id="result"></div>

  <script>
    function checkGrammar() {
      const input = document.getElementById("tpInput").value.trim().toLowerCase();
      const words = input.split(/\s+/);
      const result = document.getElementById("result");
      result.innerHTML = '';

      if (words.length < 2) {
        result.innerHTML = '<div class="error">Sentence too short to analyze.</div>';
        return;
      }

      const particles = ["li", "e", "la", "en", "anu", "pi", "taso", "kin"];
      const pronouns = ["mi", "sina"];
      const wordSet = new Set(words);

      // Check li usage
      const liIndex = words.indexOf("li");
      if (pronouns.includes(words[0]) && liIndex !== -1) {
        result.innerHTML += '<div class="error">"mi" or "sina" do not need "li".</div>';
        return;
      }
      if (!pronouns.includes(words[0]) && liIndex === -1) {
        result.innerHTML += '<div class="error">Missing "li" after subject.</div>';
        return;
      }

      // Check e usage
      const eIndices = words.map((w, i) => w === "e" ? i : -1).filter(i => i !== -1);
      for (let eIndex of eIndices) {
        if (eIndex === 0 || eIndex === words.length - 1) {
          result.innerHTML += '<div class="error">"e" must be between verb and object.</div>';
          return;
        }
        if (particles.includes(words[eIndex + 1])) {
          result.innerHTML += '<div class="error">"e" must be followed by a valid object, not a particle.</div>';
          return;
        }
      }

      result.innerHTML = '<div class="success">âœ… Sentence seems grammatically correct.</div>';
    }
  </script>
</body>
</html>
